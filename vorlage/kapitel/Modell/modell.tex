\chapter{Modell} %Modell/Modelle?
\label{chapter:mod}

\section{2-Parameter Modell}
\label{chapter:mod:2p}

Kapitelübersicht: Man kann unterscheiden zwischen verschiedenen Modellen (2p/3s) und den Arten, wie diese umgesetzt werden (Teilchensim oder PAA)

Als Grundlage für die Entwicklung eines Simulationsmodells dient die Beobachtung des chromatographischen Prozesses. Dieser ist wie in Kapitel \ref{chapter:gru} beschrieben gekennzeichnet durch viele Teilchen, welche häufig zwischen der stationären und mobilen Phase wechslen. Es liegt also nahe, dass im Modell ebenfalls Teilchen simuliert werden, die zwischen zwei Zuständen, welche die beiden Phasen repräsentieren, wechseln. Der Phasenwechsel geschieht jeweils mit einer bestimmten Wahrscheinlichkeit. Dabei kann es möglich sein, dass die Wahrscheinlichkeiten für den Wechsel in die eine oder andere Richtung voneinander abhängig sind. Da dies jedoch nicht sein muss, wird für das Modell der allgemeinere Fall von unabhängigen Wahrscheinlichkeiten angenommen. Es sei also $p_s$ die Wahrscheinlichkeit, dass ein Teilchen, welches sich bereits in der stationären Phase befindet, auch stationär bleibt und $1-p_s$ die Wahrscheinlichkeit, dass es in die mobile Phase übergeht. Analog seien $p_m$ und $1-p_m$ die Wahrscheinlichkeiten, dass ein mobiles Teilchen in der mobilen Phase bleibt bzw. zur stationären Phase wechselt. 


Damit ergibt sich als Modell ein einfacher Automat mit zwei Zuständen $\mathcal{Q} = \{s, m\}$ und den oben beschriebenen Transitionen. Eine graphische Darstellung des Modells zeigt \ref{tikz:2p_Mod} \todo{Formale Beschreibung meines Modells}

\begin{figure}[h]
 \centering

\usetikzlibrary{arrows,%
                topaths}%
\tikzstyle{knoten}=[draw,-,thick,fill=none,inner sep=0pt, minimum width=35pt, circle]
\tikzstyle{kante}=[draw,-,thick,black]
\usetikzlibrary{arrows,decorations.pathmorphing,backgrounds,positioning,fit}

\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=4cm,
  thick,main node/.style={circle,fill=white!20,draw,font=\sffamily\large\bfseries,text width = 1cm}]

  \node[main node] (s)  {\,\,\,\,\,$s$};
  \node[main node] (m) [left of=s] {\,\,\,\,$m$};

  \path[every node/.style={font=\sffamily\small}]

    (s)   edge [bend left] node [below] {$1-p_s$} (m)
            edge [loop right] node {$p_s$} (s)
        
    (m)  edge [bend left] node[above]{$1-p_m$} (s)
             edge [loop left] node {$p_m$} (m)
        ;
\end{tikzpicture}

\caption{Graphische Darstellung des 2-Parameter Modells}
\label{tikz:2p_Mod}
\end{figure}

Für die Simulation müssen viele Teilchen, ausgehend vom mobilen Zustand, den Automaten durchlaufen. Dabei wird zusätzlich zum Zustand der Teilchen auch der Ort, an dem sie sich befinden, verwaltet. Wenn sich ein Teilchen im mobilen Zustand befindet, wird dieser Ortszähler erhöht. Außerdem werden die insgesamt benötigten Schritte gezählt. Dadurch leiten sich dann die Ankunftszeiten der Teilchen bei Erreichen eines bestimmten Wertes des Ortszählers ab.

% für abbruchbedingung und zeit für peak
% Das ganze 1000 mal wiederholen da je nur eine kapillare simuliert wurde
Der genaue Ablauf der Simulation wird in Kapitel \ref{chapter:meth} beschrieben.

% Grundlage: Phasenwechsel
% Das eigentliche Modell
% Simulation je einer Kapillare und eines Stoffes -> Viele Durchläufe

\subsection{PAA zu diesem Modell}
% Modell als PAA
Blabla...

Der PAA ist formal definiert durch: $\mathcal{Q} = \{s, m\}$, $q_0 = m$, $T =
 \begin{pmatrix}
  p_{m} & 1-p_{m}  \\
  1-p_{s} & p_{s} \\
 \end{pmatrix}$, $\mathcal{E} = \{0, 1\}$, $e_s(0) = 1, e_s(1)=0, e_m(0) = 0, e_m(1)=1$,
 $\mathcal{V} = [0, \ldots, l]$ , $v_0 = 0$, $\theta_s = \theta_m = + $
 \todo{PAA für das Modell}

\begin{figure}[h]
 \centering
  \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm, thick,
   state node/.style={circle,fill=white,draw,font=\sffamily\bfseries, minimum height=30pt, text width = 1.6cm, align = center},
   operation node/.style= {regular polygon, regular polygon sides=3,  fill = white, draw, inner sep=  0pt},
   emission node/.style={rectangle, fill = lightgray!30, draw, text width = 1.8cm}]

       % \draw[fill=green] (current page.north west) rectangle (current page.south east);
%  
   \node[state node] (s) at (2, 1)  {stationär};
   \node[state node] (m) [right = of s] {mobil};
   \node[operation node, align = center] (os)  at (1.5,0.2) {$+$};
   \node[operation node, align = center] (om)  at (7.5,0.2) {$+$};

   \path[every node/.style={font=\sffamily\large}]

    (s)   edge [bend right] node [below] {$1-p_s$} (m)
            edge [loop left] node {$p_s$} (s)
        
    (m)  edge [bend right] node[above]{$1-p_m$} (s)
             edge [loop right] node {$p_m$} (m)
        ;

   \fill[color=lightgray!40] (1.1, 3.5) --(2,1.5) -- (2.9,3.5) -- cycle ;
   \fill[color=lightgray!40] (6.05, 3.5) -- (6.95,1.5) -- (7.85,3.5) -- cycle ;

   \node[emission node, align = center] (em) [above of = m] {$e_m(0) = 0$\\$e_m(1)=1$};
   \node[emission node, align = center] (es) [above of = s] {$e_s(0) = 1$\\$e_s(1)=0$};
  
  \end{tikzpicture}
  \caption{PAA für das 2-Parameter Modell} \label{PAA_2P}
\end{figure}

Und noch mehr Text, der sich auf \ref{PAA_2P} bezieht

\subsection{Grenzen des Modells}
Eine genaue Analyse der Peaks, die mit dem 2-Parameter Modell erzeugt werden können, findet sich in Kapitel \ref{chapter:eva}. An dieser Stelle sei nur vorweg genommen, dass es zwei Hauptprobleme mit dem Modell zu geben scheint. 

\todo{Umformulierung auf hypothetische Peaks}
Einfach darstellen, wie es ist (Zu jedem Zeitpunkt scheint es eine Minimalbreite zu geben, die mit diesem Modell nicht unterschritten werden kann)
, und dass es evtl wünschenswert wäre, schmalere Peaks zu manchen Zeitpunkten zu haben

** Die Sache mit den Peaks die zu schmal für meine Sim waren fällt ja quasi weg, es gibt ohne Daten keine Hinweise darauf, dass es nötig ist, schmalere Peaks zu erzeugen. Daher einfach aufschreiben, DASS da eine Grenze ist (nach oben aber fast beliebig breit)
% Zum Einen scheint es in den vorliegenden Datensätzen einige Peaks zu geben, deren kombinierte Lage und Breite nicht mit dem Modell simulierbar sind. Es ist zwar sowohl in den echten wie auch in den simulierten Daten die klare Tendenz zu erkennen, dass Peaks, die zu einer höheren Retentionszeit auftreten, auch breiter sind, als frühe Peaks. Es gibt also keine sehr schmalen Peaks am Ende des Spektrums. Allerdings existieren einige Peaks, deren Breite geringer ist, als alle mit dem Modell simulierbaren Peaks zu dieser Retentionszeit.
%Alle Simulationen ergeben zumindest geringfügig breitere Peaks. 

Zum Anderen weisen fast keine der simulierten Peaks ein Tailing auf. Lediglich ein sehr stark eingeschränkter Parameterbereich erzeugt ein Tailing. Das führt dazu, dass Tailing nur in einem sehr kleinen Retentionszeitbereich auftritt, allerdings nicht, wie es in tatsächlichen Daten zu beobachten ist, zu den eher späten Zeiten.

